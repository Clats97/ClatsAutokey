# CLATS AUTOKEY CIPHER Version 1.00

## Overview
This Python script is a custom encryption and decryption utility that implements a two-layer encryption process:

1. **Autokey Cipher:**  
   - The script first processes the plaintext by applying an autokey cipher.  
   - It extends a user-provided keyword by mixing in plaintext characters using SHA-256–based operations.  
   - Only alphabetic characters are transformed, while punctuation, numbers, and whitespace remain unchanged.

2. **XOR Stream Encryption:**  
   - After the autokey encryption, the intermediate text (converted to ASCII bytes) is further encrypted by XOR’ing it with a keystream.  
   - The keystream is derived from a SHA-256–based expansion of the keyword (via repeated hashing) combined with a cryptographically secure random nonce.  
   - A new nonce is generated for every encryption, and it is prepended to the XOR’d data. Finally, the whole block is encoded using Base64.

Additionally, the script provides a simple terminal-based interface with a clear-screen function and an ASCII art welcome screen to guide the user through encryption and decryption options.

## Features
- **Layered Encryption:**  
  The two-step process (autokey cipher and XOR stream) increases complexity.
- **Nonce Usage:**  
  A new random nonce (16 bytes) is generated each time to ensure that the same input does not produce identical ciphertext.
- **User-Friendly Interface:**  
  The home screen displays ASCII art and clear options for encrypting or decrypting text.
- **Input Validation:**  
  The script checks that the text contains at least one alphabetic character and that the keyword consists solely of alphabetic characters.

## How It Works
1. **Keyword Expansion:**  
   The provided keyword is repeatedly hashed with SHA-256 until a derived key of fixed length (default 64 bytes) is created. This derived key is used later to generate the XOR keystream.

2. **Autokey Encryption/Decryption:**  
   - In **encryption**, the keyword is extended by using a mix function (which combines the previous key character and plaintext character) to generate additional key characters.  
   - Each letter of the plaintext is then shifted based on the corresponding extended key character.
   - In **decryption**, the process is reversed: the ciphertext is shifted back using the evolving key rebuilt on the fly with each decrypted character.

3. **XOR Stream Encryption/Decryption:**  
   - The autokey–encrypted text is converted to ASCII bytes and XOR’d with a key stream.  
   - The key stream is generated by hashing the concatenation of the derived key, nonce, and a counter value.  
   - For decryption, the process is reversed by regenerating the identical key stream using the same nonce (extracted from the ciphertext) and derived key.

4. **Encoding:**  
   The final encrypted output is produced by prepending the nonce to the XOR’d data and encoding the complete binary using Base64.

## Usage
1. **Running the Script:**  
   Execute the script.

2. **Encryption:**  
   - Choose option **1** at the home screen.  
   - Enter the plaintext and an alphabetic keyword.  
   - The script outputs the encrypted text as a Base64 string.
3. **Decryption:**  
   - Choose option **2** at the home screen.  
   - Provide the Base64–encoded ciphertext and the corresponding keyword.  
   - The script returns the original plaintext if the keyword is correct.

## Security Analysis
  - **Nonce Implementation:**  
    Each encryption uses a unique, cryptographically secure nonce (generated via `os.urandom`), ensuring that the same plaintext encrypted with the same keyword produces different ciphertexts.
  - **Layered Approach:**  
    Combining an autokey cipher with XOR stream encryption adds complexity, which can be beneficial if both layers were independently secure.

**Disclaimer:**  
This tool is intended for educational and experimental purposes only. It is not recommended for securing sensitive or critical data. For applications requiring strong security guarantees, using established, industry-standard cryptographic algorithms and libraries is highly advised.

## Dependencies
- Python 3.x (with standard libraries: `os`, `hashlib`, `base64`)

- ## License

Distributed under the Apache 2.0 License. 

**Author**
Joshua M Clatney (Clats97)
Ethical Pentesting Enthusiast

Copyright 2025 Joshua M Clatney (Clats97)
